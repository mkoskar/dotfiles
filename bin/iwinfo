#!/usr/bin/env bash

if (( ! $# )); then
    exec pgx iwinfo -
fi

{
    printf '#\x20vim: ft=info'
    cd /sys/class/ieee80211 || exit
    for phy in *; do
        [[ -e $phy ]] || continue

        infohdr - iw phy "$phy" info

        infohdr - iw phy "$phy" channels

        infohdr - iw phy "$phy" reg get

        infohdr - iw phy "$phy" wowlan show

        for dev in "$phy"/device/net/*; do
            [[ -e $dev ]] || continue
            dev=${dev##*/}

            infohdr - iw dev "$dev" info

            infohdr - iw dev "$dev" link

            infohdr - iw dev "$dev" get power_save

            infohdr - iw dev "$dev" station dump -v

            infohdr - iw dev "$dev" scan dump -u
        done
    done
    echo
} |& $PAGER
